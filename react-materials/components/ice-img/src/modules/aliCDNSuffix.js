const aliCDNCropSuffix = [
  '16x16',
  '20x20',
  '24x24',
  '30x30',
  '36x36',
  '40x40',
  '48x48',
  '50x50',
  '60x30',
  '60x60',
  '60x90',
  '70x70',
  '70x1000',
  '72x72',
  '75x75',
  '75x100',
  '80x40',
  '80x60',
  '80x65',
  '81x65',
  '80x1000',
  '88x88',
  '90x45',
  '90x60',
  '90x90',
  '90x135',
  '96x54',
  '100x50',
  '100x75',
  '100x100',
  '100x150',
  '100x1000',
  '110x90',
  '110x110',
  '110x10000',
  '115x100',
  '120x0',
  '120x60',
  '120x97',
  '120x90',
  '120x160',
  '121x75',
  '125x125',
  '128x128',
  '130x130',
  '135x240',
  '140x70',
  '140x100',
  '140x140',
  '140x10000',
  '142x142',
  '145x145',
  '150x150',
  '150x200',
  '150x10000',
  '157x280',
  '160x0',
  '160x80',
  '160x90',
  '160x130',
  '160x180',
  '160x240',
  '165x5000',
  '170x170',
  '170x10000',
  '170x120',
  '180x90',
  '180x180',
  '180x230',
  '190x43',
  '190x190',
  '196x196',
  '200x0',
  '200x100',
  '200x200',
  '200x162',
  '210x140',
  '210x210',
  '210x1000',
  '220x178',
  '220x220',
  '220x330',
  '220x5000',
  '220x10000',
  '240x5000',
  '230x87',
  '230x230',
  '230x10000',
  '234x234',
  '240x180',
  '240x195',
  '240x240',
  '240x5000',
  '240x10000',
  '250x225',
  '250x250',
  '260x212',
  '260x260',
  '264x100',
  '270x0',
  '320x0',
  '270x180',
  '270x270',
  '270x450',
  '280x192',
  '280x410',
  '284x284',
  '288x480',
  '290x290',
  '290x10000',
  '292x292',
  '294x430',
  '300x1000',
  '300x10000',
  '310x310',
  '312x312',
  '300x300',
  '315x315',
  '320x260',
  '320x320',
  '320x480',
  '320x5000',
  '336x336',
  '350x350',
  '350x1000',
  '354x354',
  '360x234',
  '360x360',
  '360x10000',
  '375x280',
  '375x375',
  '400x152',
  '400x200',
  '400x400',
  '420x280',
  '430x430',
  '438x438',
  '440x440',
  '450x300',
  '450x600',
  '450x5000',
  '450x10000',
  '460x460',
  '468x468',
  '480x0',
  '480x420',
  '480x480',
  '485x175',
  '490x330',
  '490x490',
  '500x375',
  '500x450',
  '500x500',
  '500x1000',
  '540x540',
  '560x370',
  '560x560',
  '560x840',
  '568x568',
  '570x570',
  '570x10000',
  '580x580',
  '580x10000',
  '600x600',
  '600x800',
  '620x10000',
  '640x0',
  '640x360',
  '640x480',
  '640x640',
  '660x440',
  '667x667',
  '670x670',
  '720x720',
  '728x728',
  '750x388',
  '750x1000',
  '760x760',
  '790x420',
  '790x10000',
  '800x0',
  '800x800',
  '960x960',
  '970x970',
  '1080x0',
  '1080x1800',
  '1136x1136',
  '1152x1920',
  '1200x1200',
  '1280x0',
  '1280x960',
  '1280x1280',
  '2200x2200',
  '10000x220',
  '10000x340',
  '10000x170',
  '10000x500',
];

function getBestMatchSize(width, height) {
  const currentDevicePixelRatio = parseInt(window.devicePixelRatio, 10) || 1;
  const matches = aliCDNCropSuffix.filter((item) => {
    const splited = item.split('x');
    const itemWidth = parseInt(splited[0], 10);
    const itemHeight = parseInt(splited[1], 10);
    // for retina
    return (
      itemWidth >= width * currentDevicePixelRatio &&
      itemHeight >= height * currentDevicePixelRatio
    );
  });

  return matches[0] || '';
}

export default ({ width, height, quality = 90 }) => {
  width = parseFloat(width);
  height = parseFloat(height);
  // prevent string value cause error
  if (!width || !height) {
    return '';
  }

  const suffix = getBestMatchSize(width, height);

  return suffix ? `_${suffix}q${quality}.jpg` : '';
};

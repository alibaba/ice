sudo: required
language: node_js
node_js:
  - '8'
matrix:
  include:
    - os: linux  
      script:
        - npm run lint:nofix
      deploy:
        provider: script
        skip_cleanup: true # 避免清空已安装的依赖
        script: npm run generate:docs && npm run upload-oss
        on:
          all_branches: true
    - os: osx
      if: branch = iceworks/electron
      script:
        - rm -rf node_modules
        - cd tools/iceworks-app
        - npm install 
        - export CSC_IDENTITY_AUTO_DISCOVERY=false
        - npm run dist
